<!DOCTYPE html>
<html>
  <head>
	<title>Example page</title>
  </head>
  <body data-server-no-reload>
	<nav>
			<a href="index.html">Cerca Dominio</a>
			<a href="mydomain.html">I miei domini</a>
			<a href="services.html">Services</a>
			<a href="contact.html">Contact</a>
		</nav>
	<h2>Domini registrati</h2>
	<table border="1">
	  <thead>
		<tr>
		  <th>Domain Name</th>
		  <th>Registration Date</th>
		  <th>ExprirationDate</th>
		  <th>Status</th>
		</tr>
	  </thead>
	  <tbody id="domain-table-body">
		<!-- Qui andranno inserite le righe dei domini -->
	  </tbody>
	</table>
	<script>
	  const API_URI = "http://localhost:8080";
	  
	  window.onload = init();

	  async function init() {
		const userId = '123'; // Sostituisci con l'ID dell'utente reale

		try {
		  const response = await fetch(`${API_URI}/users/${userId}/domains`);
		  
		  if (!response.ok) {
			throw new Error(`Errore nella risposta: ${response.status} ${response.statusText}`);
		  }

		  const data = await response.json();
		  populateDomainTable(data);
		} catch (error) {
		  console.error('Si è verificato un errore durante il recupero dei dati:', error);
		}
		const mockDomains = generateMockData(5); // Genera 5 domini di mock data
		populateDomainTable(mockDomains);
	  }

	  function populateDomainTable(domains) {
		const tbody = document.getElementById('domain-table-body');

		domains.forEach(domain => {
		  const row = tbody.insertRow();

		  const nameCell = row.insertCell();
		  nameCell.textContent = domain.name;

		  const registrationDateCell = row.insertCell();
		  registrationDateCell.textContent = domain.registration_date;
		  const expireationDateCell = row.insertCell();
		  expireationDateCell.textContent = domain.expiration_date;
		  
		  const statusCell = row.insertCell();
		  statusCell.textContent = domain.status; 
		  //se il dominio è suo possibilita rinnovo
				//window.location.href = "./buyDomain.html?domain=${domain}&typeOperation="renew"};


		});
	  }
	function generateMockData(numDomains) {
		const mockData = [];

		const statuses = ['available', 'acquiring', 'registered', 'expired'];

		for (let i = 1; i <= numDomains; i++) {
			const domain = {
			name: `example${i}.com`,
			registration_date: randomDate(new Date(2010, 0, 1), new Date()),
			expiration_date: randomDate(new Date(2010, 0, 1), new Date()),
			status: statuses[Math.floor(Math.random() * statuses.length)]
			};

			mockData.push(domain);
		}

		return mockData;
	}

	// Funzione per generare una data casuale tra due date specificate
	function randomDate(start, end) {
		return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
	}
	</script>
  </body>
</html>


